generate.register.task("template",{build_edit:function(e,t){var a=generate.data.task.default.build(),n=a.find(".__content");return e.forEach(function(e){var t=generate.data[e.type][e.subtype].edit.build(e);n.append(t)}),a.find(".__number").text("Шаблон задания"),a.find(".__actions button").remove(),a.find("input.__group").val(t).attr("tip","Название шаблона"),a},parse_edit:function(e,t){var a={parts:[],variables:t.variables,group:""};a.group=e.find(".__group").val();for(var n=0;n<t.parts.length;n++){var r=e.find(".__content").find(".m--edit-wrapper").eq(n),i=generate.data[t.parts[n].type][t.parts[n].subtype].edit.parse(r);a.parts.push(i)}return a},builder:function(e,t,a){var n=generate.data.task.default.build(),r=n.find(".__content"),i=$('<button class="m--ghost m--icon __serialize">'+loads["Elements/Icons/serialize.svg"]+"</button>"),e=JSON.parse(JSON.stringify(e));return e.forEach(function(e){e=generate.data.task.template.unwrap_replace(e,t)}),e.forEach(function(e){var t=generate.data[e.type][e.subtype].element.build(e);t.children(".indicator").remove(),r.append(t)}),i.click(function(){generate.data.task.template.serialize(n,e,t)}),i.attr("tip","Превратить это задание в обычное"),n.find(".__make-template").replaceWith(i),a&&n.find("input.__group").val(a),n.find("input.__group").attr("disabled","disabled"),n.find(".__content").children().each(function(){$(this).unbind("click").removeClass("m--pullable").removeClass("m--put-zone")}),n.addClass("m--template"),n}});