function drag_over(t){return t.preventDefault&&(t.preventDefault(),t.stopPropagation()),!1}function drag_reset(){$(".group").css("background",""),counter=0,check_for_emptiness()}function check_for_emptiness(){$(".group").each(function(t,e){console.log($(this).children().length,$(this).children()),1==$(this).children().length?$(this).append("<div class='empty'>Пустая группа</div>"):$(this).children(".empty").remove()})}function toggle_edit(){editing?($("h3").css("border-bottom","1px dashed transparent").attr("contenteditable","false"),$(".button_remove").remove(),$(".students .link--card").attr("draggable","false"),$(".students .link--card").each(function(t,e){$(this).replaceTag("<a>",!0)}),editing=!1):($("h3").css("border-bottom","1px dashed #2196F3").attr("contenteditable","true"),$(".students .link--card").attr("draggable","true"),$(".students .link--card,.teachers .link--card").each(function(t,e){$(this).replaceTag("<div>",!0)}),$(".students .link--card").bind({dragstart:function(t){t.originalEvent.dataTransfer.setData("useless","stupid firefox"),e_data.original_el=$(this)},dragend:function(t){drag_reset()}}),editing=!0,$(".card-person").prepend(button_remove),$(".button_remove").click(function(t){$(this).parent().parent().remove(),check_for_emptiness()}))}var editing=!1,e_data={},counter=0,button_remove='<button class="button--icon button_remove"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M16 3C8.832 3 3 8.832 3 16s5.832 13 13 13 13-5.832 13-13S23.168 3 16 3zm0 2c6.087 0 11 4.913 11 11s-4.913 11-11 11S5 22.087 5 16 9.913 5 16 5zm-3.78 5.78l-1.44 1.44L14.564 16l-3.782 3.78 1.44 1.44L16 17.437l3.78 3.78 1.44-1.437L17.437 16l3.78-3.78-1.437-1.44L16 14.564l-3.78-3.782z"/></svg></button>';$(document).ready(function(){$("h3").css("border-bottom","1px dashed transparent"),$("#edit").click(function(t){toggle_edit()}),$("#invite_teacher").click(function(t){popup.show("<input type='email' id='email'><label for='email' required>Email</label><br><br><button id='invite_teacher_button'>Пригласить</button>",{width:"20rem"},function(){add_menu_caller($("#popup .select").get(0)),$("#popup input")[0].focus(),$("#invite_teacher_button").click(function(t){var e=new FormData;e.append("email",$("#email").val()),e.append("course","{{course.title_lat}}"),e.append("csrfmiddlewaretoken","{{ csrf_token }}"),$.ajax({type:"POST",url:"/func/add_teacher/",data:e,processData:!1,contentType:!1,success:function(){notification.change("success","Преподаватель приглашен","Ждем от него подтвкерждения")}})})})}),$("#invite_students").click(function(t){popup.show("<input type='email' class='student__email'><label for='email'>Email</label><br><button class='button--icon' id='add_student'><svg  viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'><path d='M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z'/><path d='M0 0h24v24H0z' fill='none'/></svg></button><div class='select'><div class='display'>Нераспределенные</div><svg class='{{ class }}' id='{{id}}' viewBox='0 0 24 24'  xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/><path d='M0 0h24v24H0z' fill='none'/></svg><input type='hidden' name='subject' class='value'><option value='unordered'>Нераспределенные</option><option value='10I'>10И</option><option value='10D'>10Б</option></div><br><br><br><button id='invite_students_button'>Пригласить</button>",{width:"20rem"},function(){add_menu_caller($("#popup .select").get(0)),$("#popup input")[0].focus(),$("#add_student").click(function(t){$("#popup .student__email+label").last().after("<input type='email' class='student__email'><label for='email'>Email</label>"),add_emptiness_checker($("#popup .student__email").last()[0])}),$("#invite_students_button").click(function(t){var e=new FormData,n=[];$("#popup .student__email").each(function(t,e){n.push($(this).val())}),console.log(n.join(","),n),e.append("email_list",n.join(",")),e.append("course","{{course.title_lat}}"),e.append("csrfmiddlewaretoken","{{ csrf_token }}"),$.ajax({type:"POST",url:"/func/add_teacher/",data:e,processData:!1,contentType:!1,success:function(){notification.change("success","Преподаватель приглашен","Ждем от него подтвкерждения")}})})})}),$(".group").on({dragover:function(t){drag_over(t)},dragenter:function(t){0==counter&&$(this).css("background","black"),counter++},dragleave:function(t){counter--,0==counter&&$(this).css("background","")},drop:function(t){$(this).append(e_data.original_el)}})}),$.extend({replaceTag:function(t,e,n){var a,i=$(t),o=$(e).clone();if(n){newTag=o[0];for(var s,a=0,r=t.attributes,c=r.length;c>a;a++)s=r[a],newTag.setAttribute(s.nodeName,s.nodeValue);$.extend(newTag.classList,t.classList),$.extend(newTag.attributes,t.attributes)}return i.wrapAll(o),i.contents().unwrap(),this}}),$.fn.extend({replaceTag:function(t,e){return this.each(function(){jQuery.replaceTag(this,t,e)})}});