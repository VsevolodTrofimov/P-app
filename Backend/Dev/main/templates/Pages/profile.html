<!DOCTYPE html>
<html>
<head>
	{% include "UI_elements/unique/head_info.html" %}
	<div class="includer">{% include 'CSS/Logo mini.html' %}</div>
	{% if request.user.email = user.email %}
		<title>Настройки Профиля</title>
	{% else %}
		<title>{{user.name}}(Профиль)</title>
	{% endif %}
</head>
<body>
	<div class="includer">{% include 'CSS/main.html' %}</div>
	<div class="includer">{% include 'CSS/course.html' %}</div>
	<div class="includer">{% include 'CSS/header.html' %}</div>
	<div class="includer">{% include 'CSS/cards.html' %}</div>
	<div class="includer">{% include 'CSS/buttons.html' %}</div>
	<div class="includer">{% include 'CSS/inputs.html' %}</div>
	<div class="includer">{% include 'CSS/notification.html' %}</div>
	<main>
		<section>
			{% include 'UI_elements/cards/person.html' with user=user %}
		</section>

		<section>
			<div class="card">
				<h4 class="card__heading">Контакты</h4>
				<button class="button--icon" id="add_contact">
					{% include 'UI_elements/Icons/add.svg' with id='fuck' %}
				</button>
				<div class="card-contacts__item" id="email">
					<h5>email</h5>
					{{ user.email }}
				</div>
				<div class="card-contacts__item" id="skype">
					<h5>skype</h5>
					{{ user.skype }}
				</div>
				<div class="card-contacts__item" id="cf">
					<h5>codeforces</h5>
					{{ user.codeforces }}
				</div>
			</div>
		</section>
		{% if request.user.email = user.email %}
			<section>
				<div class="card card-settings">
					<h4 class="card__heading">Настройки профиля</h4>
					Мои контакты могут просматривать:
					<form>
						<input type="radio" id="radio_1" name="contacts_see" checked><label for="radio_1">Все</label>
						<input type="radio" id="radio_2" name="contacts_see"><label for="radio_2">Только учителя</label>
						<input type="radio" id="radio_3" name="contacts_see"><label for="radio_3">Только ученики</label>
						<input type="radio" id="radio_4" name="contacts_see"><label for="radio_4">Только мои учителя и одногруппники</label>
						<input type="radio" id="radio_5" name="contacts_see"><label for="radio_5">Никто</label>
					</form>
					<br><br>
					<a href="/forgot_password/">Сменить пароль</a>
					<button class="button--ghost" href="/logout/"></button>
				</div>
			</section>
			<button id="fab">
				{% include 'UI_elements/Icons/edit.svg' with id='fab-ico'%}
			</button>
		{% endif %}
	</main>

	<div class="includer">{% include 'JS/jquery-2.html' %}</div>
	<div class="includer">{% include 'JS/humanize.html' %}</div>
	<div class="includer">{% include 'JS/layout.html' %}</div>
	<div class="includer">{% include 'JS/ripple.html' %}</div>
	{% include "UI_elements/unique/notification.html" %}
	{% include "UI_elements/unique/header.html" %}
	
	{% if request.user.email = user.email %}
		<script>
			$(document).ready(function() {

				var editing = false;

				function toggle_edit() {
					if(editing) {
						$("[contenteditable]").attr("contenteditable", "false").css('border-bottom', '1px dotted transparent');
						$("#add_contact").css('transform', 'scale(0)');
						editing = false;
					} else {
						$(".card-contacts__item, .card-person__name").attr("contenteditable", "true").css('border-bottom', '1px dotted #2196F3');
						$("#add_contact").css('transform', 'scale(1)');
						editing = true;
						$("[contenteditable]").bind("blur", function() {
							$.ajax({
				                 type:"GET",
				                 url:"/func/change_data/",
				                 data: {
				                        'email': $('#email').html()
				                        },
				                 success: function(){
				                     notification.change('success','Успешно','Данные были успешно изменены' );
				                 }
				            });
						});

					}
				}

				$("#fab").click(function(event) {
					toggle_edit();
				});

				$(".card-person__avatar").click(function(event) {
					if(editing) {
						//change avatar
					}
				});
				new_contact = '<div class="card-contacts__item"><h5>Сервис</h5>Ваши данные</div>';
				$("#add_contact").click(function(event) {
					$("#contacts").append($(new_contact).attr("contenteditable", "true").css('border-bottom', '1px dotted #2196F3'));
				});
			});
	</script>
	{% endif %}
</body>
</html>